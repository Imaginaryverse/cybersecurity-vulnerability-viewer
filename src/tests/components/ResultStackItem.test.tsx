import { render, screen } from '@testing-library/react';
import { ResultStackItem } from '../../components/organisms/ResultsStack/ResultStackItem';
import { parsedFullCve1 } from '../data/parsed_cve_1';

describe('<ResultStackItem />', () => {
  describe('when given a cve', () => {
    it('should render the cve id', () => {
      render(<ResultStackItem cve={parsedFullCve1} onViewClick={() => null} />);
      expect(screen.getByText('CVE-2002-2038')).toBeInTheDocument();
    });

    it('should render the cve description', () => {
      render(<ResultStackItem cve={parsedFullCve1} onViewClick={() => null} />);
      expect(
        screen.getByText(
          'Next Generation POSIX Threading (NGPT) 1.9.0 uses a filesystem-based shared memory entry, which allows local users to cause a denial of service or in threaded processes or spoof files via unknown meth...'
        )
      ).toBeInTheDocument();
    });

    it('should render the cve base score', () => {
      render(<ResultStackItem cve={parsedFullCve1} onViewClick={() => null} />);
      expect(screen.getByText('3.6')).toBeInTheDocument();
    });
  });
});
