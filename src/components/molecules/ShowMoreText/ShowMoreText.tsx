import { ExpandLess, ExpandMore } from '@mui/icons-material';
import { Box, Link, Typography } from '@mui/material';
import { FunctionComponent, useCallback, useMemo, useState } from 'react';

type ShowMoreTextProps = {
  text: string;
  limit: number;
};

export const ShowMoreText: FunctionComponent<ShowMoreTextProps> = ({
  text,
  limit,
}) => {
  const [isExpanded, setShowMore] = useState(false);

  const toggleShowMore = useCallback(() => setShowMore(prev => !prev), []);

  const displayText = useMemo(() => {
    if (text.length <= limit) {
      return text;
    }

    if (isExpanded) {
      return text;
    }

    return text.slice(0, limit) + '...';
  }, [text, limit, isExpanded]);

  return (
    <Box
      sx={{
        display: 'flex',
        flexDirection: 'column',
        marginBottom: '1rem',
      }}
    >
      <Typography variant='body1' gutterBottom maxWidth='55rem'>
        {displayText}
      </Typography>

      {text.length > limit && (
        <Link
          onClick={toggleShowMore}
          fontSize={14}
          color='primary'
          fontWeight={600}
          sx={{
            display: 'flex',
            alignItems: 'center',
            cursor: 'pointer',
            margin: '0 auto',
          }}
        >
          {isExpanded ? <ExpandLess /> : <ExpandMore />}
          {isExpanded ? 'Show less' : 'Show more'}
        </Link>
      )}
    </Box>
  );
};
