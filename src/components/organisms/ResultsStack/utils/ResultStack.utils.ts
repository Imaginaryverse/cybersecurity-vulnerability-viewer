import { ParsedCve } from '../../../../types/CVE.types';
import { SortOptionType } from '../types/ResultsStack.types';

export function sortCves(cves: ParsedCve[], sortOption: SortOptionType) {
  return cves.sort((a, b) => {
    switch (sortOption) {
      case SortOptionType.CVE_ID_A_Z:
        return a.id.localeCompare(b.id);
      case SortOptionType.CVE_ID_Z_A:
        return b.id.localeCompare(a.id);
      case SortOptionType.BASE_SCORE_LOW_HIGH:
        return (a.metrics?.baseScore ?? 0) - (b.metrics?.baseScore ?? 0);
      case SortOptionType.BASE_SCORE_HIGH_LOW:
        return (b.metrics?.baseScore ?? 0) - (a.metrics?.baseScore ?? 0);
      case SortOptionType.LAST_MODIFIED_OLD_NEW:
        return a.lastModified?.localeCompare(b.lastModified ?? '') ?? 0;
      case SortOptionType.LAST_MODIFIED_NEW_OLD:
        return b.lastModified?.localeCompare(a.lastModified ?? '') ?? 0;
      case SortOptionType.PUBLISHED_OLD_NEW:
        return a.published?.localeCompare(b.published ?? '') ?? 0;
      case SortOptionType.PUBLISHED_NEW_OLD:
        return b.published?.localeCompare(a.published ?? '') ?? 0;
      default:
        return 0;
    }
  });
}
