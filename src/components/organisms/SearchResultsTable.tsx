import { FunctionComponent } from 'react';
import {
  Table,
  TableHead,
  TableRow,
  TableCell,
  TableBody,
} from '@mui/material';
import { useNavigate } from 'react-router-dom';

import { ParsedCve } from '../../types/CVE.types';
import { formatDateKey } from '../../utils/dateUtils';

type SearchResultsTableProps = {
  cves: ParsedCve[];
};

export const SearchResultsTable: FunctionComponent<SearchResultsTableProps> = ({
  cves,
}) => {
  const navigate = useNavigate();

  if (!cves.length) {
    return null;
  }

  return (
    <Table>
      <TableHead>
        <TableRow>
          <TableCell>ID</TableCell>
          <TableCell>Score</TableCell>
          <TableCell>Modified</TableCell>
          <TableCell>Published</TableCell>
        </TableRow>
      </TableHead>
      <TableBody>
        {cves.map(cve => (
          <TableRow
            key={cve.id}
            hover
            onClick={() =>
              navigate(`/vulnerability/${cve.id}`, { state: { cve } })
            }
            sx={{
              cursor: 'pointer',
            }}
          >
            <TableCell>{cve.id}</TableCell>
            <TableCell>{cve.metrics?.baseScore ?? 'N/A'}</TableCell>
            <TableCell>{formatDateKey(cve.lastModified)}</TableCell>
            <TableCell>{formatDateKey(cve.published)}</TableCell>
          </TableRow>
        ))}
      </TableBody>
    </Table>
  );
};
