import { FunctionComponent } from 'react';
import { Typography } from '@mui/material';
import { ParsedCve } from '../../../types/CVE.types';
import { CustomList } from '../../../components/molecules/CustomList';

type Props = {
  cve: ParsedCve;
};

export const CveConfigurationsList: FunctionComponent<Props> = ({ cve }) => {
  if (!cve.configurations.length) {
    return null;
  }

  return (
    <CustomList
      label='Configurations'
      data={cve.configurations}
      itemElevation={1}
      render={conf => (
        <>
          <Typography variant='body1' gutterBottom>
            <b>Match Criteria ID:</b> {conf.cpeMatch.matchCriteriaId}
          </Typography>
          <Typography
            variant='body1'
            gutterBottom
            sx={{ overflowWrap: 'anywhere' }}
          >
            <b>Criteria:</b> {conf.cpeMatch.criteria}
          </Typography>
          <Typography variant='body1' gutterBottom>
            <b>Vulnerable:</b> {String(conf.cpeMatch.vulnerable)}
          </Typography>
          <Typography variant='body1' gutterBottom>
            <b>Operator:</b> {conf.operator}
          </Typography>
          <Typography variant='body1' gutterBottom>
            <b>Negate:</b> {String(conf.negate)}
          </Typography>
        </>
      )}
    />
  );
};
