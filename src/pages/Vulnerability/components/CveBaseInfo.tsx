import { FunctionComponent } from 'react';
import { ParsedCve } from '../../../types/CVE.types';
import { Card, Grid, Typography } from '@mui/material';

type Props = {
  cve: ParsedCve;
};

export const CveBaseInfo: FunctionComponent<Props> = ({ cve }) => {
  if (!cve) {
    return null;
  }

  return (
    <Card
      elevation={0}
      sx={{
        height: '100%',
        display: 'flex',
        flexDirection: 'column',
        justifyContent: 'space-between',
        alignItems: 'flex-start',
        gap: '1rem',
        marginTop: '1rem',
      }}
    >
      <Typography variant='h4'>Summary</Typography>

      <Typography variant='body1' gutterBottom>
        {cve.description}
      </Typography>

      <Grid container spacing={2}>
        <Grid xs={12} md={6} item>
          <Typography variant='body2'>
            <b>Status:</b> {cve.vulnStatus}
          </Typography>
        </Grid>

        <Grid xs={12} md={6} item>
          <Typography variant='body2'>
            <b>Source:</b> {cve.sourceIdentifier}
          </Typography>
        </Grid>

        <Grid xs={12} md={6} item>
          <Typography variant='body2'>
            <b>Version:</b> {cve.metrics?.version || 'N/A'}
          </Typography>
        </Grid>

        <Grid xs={12} md={6} item>
          <Typography variant='body2' sx={{ overflowWrap: 'anywhere' }}>
            <b>Vector:</b> {cve.metrics?.vectorString || 'N/A'}
          </Typography>
        </Grid>
      </Grid>
    </Card>
  );
};
