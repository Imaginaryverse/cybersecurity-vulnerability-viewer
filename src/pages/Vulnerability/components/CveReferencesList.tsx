import { FunctionComponent } from 'react';
import { ParsedCve } from '../../../types/CVE.types';
import { List, ListItem, Typography, Link, Box } from '@mui/material';

type Props = {
  cve: ParsedCve;
};

export const CveReferencesList: FunctionComponent<Props> = ({ cve }) => {
  if (!cve) {
    return null;
  }

  return (
    <Box sx={{ mt: 2 }}>
      <Typography variant='h6' gutterBottom>
        References
      </Typography>
      <List
        sx={{
          marginLeft: '1.5rem',
        }}
      >
        {cve.references?.map(ref => (
          <ListItem
            key={ref.url}
            sx={{
              display: 'list-item',
              listStyleType: 'disc',
              padding: '0.5rem',
            }}
          >
            <Typography variant='body2'>
              <b>Source:</b> {ref.source}
            </Typography>
            <Typography variant='body2'>
              <b>URL:</b>{' '}
              <Link href={ref.url} target='_blank' rel='noopener noreferrer'>
                {ref.url}
              </Link>
            </Typography>
          </ListItem>
        ))}
      </List>
    </Box>
  );
};
