import { FunctionComponent } from 'react';
import { ParsedCve } from '../../../types/CVE.types';
import { Card, Typography } from '@mui/material';
import { SeverityType } from '../../../types/CVSS.enums';
import { SeverityGauge } from '../../../components/organisms/SeverityGauge';

type Props = {
  cve: ParsedCve;
};

export const CveBaseScoreGauge: FunctionComponent<Props> = ({ cve }) => {
  if (!cve?.metrics?.baseScore) {
    return null;
  }

  return (
    <Card
      elevation={0}
      sx={{
        height: '100%',
        display: 'flex',
        flexDirection: 'column',
        justifyContent: 'flex-start',
        alignItems: 'center',
        marginTop: '1rem',
      }}
    >
      <Typography
        variant='h4'
        sx={{
          marginBottom: '2rem',
        }}
      >
        {cve.id}
      </Typography>

      <SeverityGauge
        value={cve.metrics?.baseScore}
        label={
          cve.metrics?.baseSeverity !== SeverityType.NOT_DEFINED
            ? cve.metrics?.baseSeverity
            : undefined
        }
      />
    </Card>
  );
};
