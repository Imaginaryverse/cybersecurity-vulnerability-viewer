import { FunctionComponent } from 'react';
import { ParsedCve } from '../../../types/CVE.types';
import { Card, Grid, Typography } from '@mui/material';
import { toHumanReadableDate } from '../../../utils/dateUtils';

type Props = {
  cve: ParsedCve;
};

export const CveSummaryCard: FunctionComponent<Props> = ({ cve }) => {
  if (!cve) {
    return null;
  }

  const XS = 6; // defines the width of the grid item on mobile
  const MD = 6; // defines the width of the grid item on desktop

  return (
    <Card
      elevation={1}
      sx={{
        height: '100%',
        display: 'flex',
        flexDirection: 'column',
        gap: '1rem',
        padding: '1rem',
      }}
    >
      <Typography variant='h4' gutterBottom>
        {cve.id}
      </Typography>

      <Typography variant='body1' gutterBottom>
        {cve.description}
      </Typography>

      <Grid container spacing={2}>
        <Grid xs={XS} md={MD} item>
          <Typography variant='body2'>
            <b>Published:</b> {toHumanReadableDate(cve.published, true)}
          </Typography>
        </Grid>

        <Grid xs={XS} md={MD} item>
          <Typography variant='body2'>
            <b>Modified:</b> {toHumanReadableDate(cve.lastModified, true)}
          </Typography>
        </Grid>

        <Grid xs={XS} md={MD} item>
          <Typography variant='body2'>
            <b>Score:</b> {cve.metrics?.baseScore || 'N/A'}
          </Typography>
        </Grid>

        <Grid xs={XS} md={MD} item>
          <Typography variant='body2'>
            <b>Severity:</b> {cve.metrics?.baseSeverity || 'N/A'}
          </Typography>
        </Grid>

        <Grid xs={XS} md={MD} item>
          <Typography variant='body2'>
            <b>Type:</b> {cve.metrics?.type || 'N/A'}
          </Typography>
        </Grid>

        <Grid xs={XS} md={MD} item>
          <Typography variant='body2'>
            <b>Status:</b> {cve.vulnStatus}
          </Typography>
        </Grid>

        <Grid xs={XS} md={MD} item>
          <Typography variant='body2' sx={{ overflowWrap: 'anywhere' }}>
            <b>Source:</b> {cve.sourceIdentifier}
          </Typography>
        </Grid>

        <Grid xs={XS} md={MD} item>
          <Typography variant='body2'>
            <b>Version:</b> {cve.metrics?.version || 'N/A'}
          </Typography>
        </Grid>
      </Grid>
    </Card>
  );
};
