import { FunctionComponent } from 'react';
import { ParsedCve } from '../../../types/CVE.types';
import { Typography } from '@mui/material';
import { CustomList } from '../../../components/molecules';

type Props = {
  cve: ParsedCve;
};

export const CveWeaknessesList: FunctionComponent<Props> = ({ cve }) => {
  if (!cve.weaknesses.length) {
    return null;
  }

  return (
    <CustomList
      label='Weaknesses'
      data={cve.weaknesses}
      itemElevation={1}
      render={weakness => (
        <>
          <Typography variant='body1' gutterBottom>
            <b>Description:</b> {weakness.description}
          </Typography>
          <Typography variant='body1' gutterBottom>
            <b>Type:</b> {weakness.type}
          </Typography>
          <Typography
            variant='body1'
            gutterBottom
            sx={{ overflowWrap: 'anywhere' }}
          >
            <b>Source:</b> {weakness.source}
          </Typography>
        </>
      )}
    />
  );
};
